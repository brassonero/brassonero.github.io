<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Examen - Cumplimiento Normativo y Resiliencia BBVA</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;600&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-primary: #0a0f1a;
            --bg-secondary: #111827;
            --bg-tertiary: #1f2937;
            --bg-card: #151d2e;
            --accent-blue: #0066cc;
            --accent-cyan: #06b6d4;
            --accent-emerald: #10b981;
            --accent-amber: #f59e0b;
            --accent-red: #ef4444;
            --accent-purple: #8b5cf6;
            --accent-pink: #ec4899;
            --text-primary: #f9fafb;
            --text-secondary: #9ca3af;
            --text-muted: #6b7280;
            --border-color: #374151;
            --glow-cyan: 0 0 30px rgba(6, 182, 212, 0.25);
            --glow-emerald: 0 0 25px rgba(16, 185, 129, 0.3);
            --glow-red: 0 0 20px rgba(239, 68, 68, 0.3);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Inter', sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            min-height: 100vh;
            line-height: 1.6;
        }

        .bg-pattern {
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            background: 
                radial-gradient(ellipse at 10% 90%, rgba(6, 182, 212, 0.12) 0%, transparent 50%),
                radial-gradient(ellipse at 90% 10%, rgba(16, 185, 129, 0.1) 0%, transparent 50%),
                linear-gradient(rgba(6, 182, 212, 0.02) 1px, transparent 1px),
                linear-gradient(90deg, rgba(6, 182, 212, 0.02) 1px, transparent 1px);
            background-size: 100% 100%, 100% 100%, 50px 50px, 50px 50px;
            pointer-events: none;
            z-index: 0;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 2rem;
            position: relative;
            z-index: 1;
        }

        .header {
            text-align: center;
            margin-bottom: 2.5rem;
            padding: 2.5rem 2rem;
            background: linear-gradient(135deg, var(--bg-card) 0%, var(--bg-secondary) 100%);
            border-radius: 24px;
            border: 1px solid var(--border-color);
            position: relative;
            overflow: hidden;
        }

        .header::before {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--accent-cyan), var(--accent-emerald), var(--accent-amber), var(--accent-cyan));
            background-size: 300% 100%;
            animation: gradient-shift 5s ease infinite;
        }

        @keyframes gradient-shift {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }

        .logo-container {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 1.5rem;
            margin-bottom: 1rem;
        }

        .logo-icon {
            width: 75px; height: 75px;
            background: linear-gradient(135deg, var(--accent-cyan), var(--accent-emerald));
            border-radius: 18px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2.2rem;
            box-shadow: var(--glow-cyan);
        }

        .header h1 {
            font-size: 1.9rem;
            font-weight: 700;
            background: linear-gradient(135deg, var(--text-primary), var(--accent-cyan));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .header .subtitle {
            color: var(--text-secondary);
            font-size: 1rem;
            margin-top: 0.5rem;
        }

        .badge-container {
            display: flex;
            gap: 0.5rem;
            justify-content: center;
            margin-top: 1rem;
            flex-wrap: wrap;
        }

        .badge {
            display: inline-block;
            padding: 0.3rem 0.8rem;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 600;
            letter-spacing: 0.5px;
        }

        .badge-cyan { background: var(--accent-cyan); color: black; }
        .badge-emerald { background: var(--accent-emerald); color: white; }
        .badge-amber { background: var(--accent-amber); color: black; }

        .stats-bar {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .stat-card {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 14px;
            padding: 1.2rem;
            text-align: center;
            transition: all 0.3s ease;
        }

        .stat-card:hover { transform: translateY(-2px); }
        .stat-card.correct-stat { border-color: var(--accent-emerald); }
        .stat-card.incorrect-stat { border-color: var(--accent-red); }

        .stat-value {
            font-family: 'JetBrains Mono', monospace;
            font-size: 2rem;
            font-weight: 600;
            background: linear-gradient(135deg, var(--accent-cyan), var(--accent-emerald));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .stat-value.correct { color: var(--accent-emerald); background: none; -webkit-text-fill-color: var(--accent-emerald); }
        .stat-value.incorrect { color: var(--accent-red); background: none; -webkit-text-fill-color: var(--accent-red); }

        .stat-label {
            font-size: 0.8rem;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-top: 0.3rem;
        }

        .progress-container {
            background: var(--bg-tertiary);
            border-radius: 10px;
            height: 10px;
            margin-bottom: 2rem;
            overflow: hidden;
        }

        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, var(--accent-cyan), var(--accent-emerald));
            border-radius: 10px;
            transition: width 0.5s ease;
            box-shadow: var(--glow-cyan);
        }

        .question-card {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 20px;
            padding: 2rem;
            margin-bottom: 1.5rem;
            transition: all 0.3s ease;
        }

        .question-card:hover { border-color: rgba(6, 182, 212, 0.4); }
        .question-card.answered-correct { border-color: var(--accent-emerald); box-shadow: var(--glow-emerald); }
        .question-card.answered-incorrect { border-color: var(--accent-red); box-shadow: var(--glow-red); }

        .question-header {
            display: flex;
            align-items: center;
            gap: 0.8rem;
            margin-bottom: 1.5rem;
            flex-wrap: wrap;
        }

        .question-number {
            background: linear-gradient(135deg, var(--accent-cyan), var(--accent-emerald));
            color: black;
            font-family: 'JetBrains Mono', monospace;
            font-weight: 600;
            padding: 0.5rem 1rem;
            border-radius: 10px;
            font-size: 0.85rem;
        }

        .question-category {
            font-size: 0.8rem;
            color: var(--text-muted);
            background: var(--bg-tertiary);
            padding: 0.4rem 0.8rem;
            border-radius: 6px;
        }

        .question-type {
            font-size: 0.7rem;
            padding: 0.25rem 0.5rem;
            border-radius: 4px;
            font-weight: 600;
            text-transform: uppercase;
        }
        .question-type.scenario { background: var(--accent-pink); color: white; }
        .question-type.conceptual { background: var(--accent-purple); color: white; }
        .question-type.technical { background: var(--accent-cyan); color: black; }
        .question-type.tricky { background: var(--accent-amber); color: black; }

        .difficulty-badge {
            font-size: 0.7rem;
            padding: 0.25rem 0.5rem;
            border-radius: 4px;
            font-weight: 600;
        }
        .difficulty-badge.expert { background: #dc2626; color: white; }
        .difficulty-badge.hard { background: var(--accent-amber); color: black; }
        .difficulty-badge.medium { background: var(--accent-emerald); color: white; }

        .question-text {
            font-size: 1.05rem;
            color: var(--text-primary);
            margin-bottom: 1.5rem;
            line-height: 1.8;
        }

        .scenario-box {
            background: rgba(6, 182, 212, 0.1);
            border: 1px solid rgba(6, 182, 212, 0.3);
            border-radius: 12px;
            padding: 1.2rem;
            margin-bottom: 1.5rem;
            font-size: 0.95rem;
            color: var(--text-secondary);
            line-height: 1.7;
        }

        .scenario-box strong { color: var(--accent-cyan); }

        .options-list { display: flex; flex-direction: column; gap: 0.75rem; }

        .option {
            display: flex;
            align-items: flex-start;
            gap: 1rem;
            padding: 1rem 1.2rem;
            background: var(--bg-secondary);
            border: 2px solid var(--border-color);
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .option:hover:not(.disabled) {
            border-color: var(--accent-cyan);
            background: rgba(6, 182, 212, 0.1);
            transform: translateX(4px);
        }

        .option.correct { border-color: var(--accent-emerald); background: rgba(16, 185, 129, 0.15); }
        .option.incorrect { border-color: var(--accent-red); background: rgba(239, 68, 68, 0.15); }
        .option.disabled { cursor: not-allowed; opacity: 0.7; }
        .option.show-correct { border-color: var(--accent-emerald); background: rgba(16, 185, 129, 0.1); }

        .option-letter {
            width: 38px; height: 38px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: var(--bg-tertiary);
            border-radius: 10px;
            font-family: 'JetBrains Mono', monospace;
            font-weight: 600;
            color: var(--text-secondary);
            transition: all 0.3s ease;
            flex-shrink: 0;
        }

        .option:hover:not(.disabled) .option-letter { background: var(--accent-cyan); color: black; }
        .option.correct .option-letter { background: var(--accent-emerald); color: white; }
        .option.incorrect .option-letter { background: var(--accent-red); color: white; }
        .option.show-correct .option-letter { background: var(--accent-emerald); color: white; }

        .option-text { flex: 1; color: var(--text-primary); font-size: 0.95rem; line-height: 1.5; }

        .option-feedback { font-size: 0.85rem; font-weight: 500; margin-left: auto; flex-shrink: 0; }
        .option-feedback.correct { color: var(--accent-emerald); }
        .option-feedback.incorrect { color: var(--accent-red); }

        .feedback-message {
            margin-top: 1.5rem;
            padding: 1rem 1.5rem;
            border-radius: 12px;
            display: flex;
            align-items: center;
            gap: 1rem;
            font-weight: 500;
        }

        .feedback-message.correct { background: rgba(16, 185, 129, 0.15); border: 1px solid var(--accent-emerald); color: var(--accent-emerald); }
        .feedback-message.incorrect { background: rgba(239, 68, 68, 0.15); border: 1px solid var(--accent-red); color: var(--accent-red); }

        .feedback-icon { font-size: 1.5rem; }

        .explanation {
            margin-top: 1rem;
            padding: 1rem 1.2rem;
            background: rgba(6, 182, 212, 0.08);
            border-left: 3px solid var(--accent-cyan);
            border-radius: 0 10px 10px 0;
            font-size: 0.9rem;
            color: var(--text-secondary);
            line-height: 1.6;
        }

        .explanation strong { color: var(--accent-cyan); }

        .navigation {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 2rem;
            gap: 1rem;
            flex-wrap: wrap;
        }

        .btn {
            font-family: 'Inter', sans-serif;
            font-size: 1rem;
            font-weight: 500;
            padding: 0.9rem 2rem;
            border-radius: 12px;
            border: none;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .btn-primary { background: linear-gradient(135deg, var(--accent-cyan), var(--accent-emerald)); color: black; }
        .btn-primary:hover { transform: translateY(-2px); box-shadow: var(--glow-cyan); }
        .btn-secondary { background: var(--bg-tertiary); color: var(--text-primary); border: 1px solid var(--border-color); }
        .btn-secondary:hover { border-color: var(--accent-cyan); }
        .btn:disabled { opacity: 0.5; cursor: not-allowed; transform: none; }

        .question-nav {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(42px, 1fr));
            gap: 0.4rem;
            padding: 1.5rem;
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 16px;
            margin-bottom: 2rem;
            max-height: 200px;
            overflow-y: auto;
        }

        .nav-btn {
            width: 42px; height: 42px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 10px;
            color: var(--text-secondary);
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.75rem;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .nav-btn:hover { border-color: var(--accent-cyan); color: var(--accent-cyan); }
        .nav-btn.current { background: linear-gradient(135deg, var(--accent-cyan), var(--accent-emerald)); border-color: transparent; color: black; }
        .nav-btn.correct { background: var(--accent-emerald); border-color: transparent; color: white; }
        .nav-btn.incorrect { background: var(--accent-red); border-color: transparent; color: white; }

        .results-container { text-align: center; padding: 3rem; }
        .results-score { font-size: 5rem; font-weight: 700; background: linear-gradient(135deg, var(--accent-cyan), var(--accent-emerald)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; margin-bottom: 1rem; }
        .results-grade { font-size: 2rem; margin-bottom: 2rem; }
        .results-stats { display: grid; grid-template-columns: repeat(3, 1fr); gap: 1.5rem; margin: 2rem 0; }
        .result-stat { background: var(--bg-tertiary); padding: 1.5rem; border-radius: 14px; }
        .result-stat-value { font-family: 'JetBrains Mono', monospace; font-size: 2.2rem; font-weight: 600; }
        .result-stat-value.correct { color: var(--accent-emerald); }
        .result-stat-value.incorrect { color: var(--accent-red); }
        .result-stat-value.unanswered { color: var(--accent-amber); }

        .start-screen { text-align: center; padding: 3rem; }
        .start-screen h2 { font-size: 1.8rem; margin-bottom: 1.5rem; }

        .start-info { display: grid; grid-template-columns: repeat(2, 1fr); gap: 1rem; margin: 2rem 0; text-align: left; }
        .info-item { background: var(--bg-tertiary); padding: 1.2rem; border-radius: 14px; display: flex; align-items: center; gap: 1rem; border: 1px solid var(--border-color); }
        .info-icon { width: 48px; height: 48px; background: linear-gradient(135deg, var(--accent-cyan), var(--accent-emerald)); border-radius: 12px; display: flex; align-items: center; justify-content: center; font-size: 1.4rem; }
        .info-text h4 { font-size: 0.85rem; color: var(--text-muted); font-weight: 400; }
        .info-text p { font-size: 1.05rem; color: var(--text-primary); font-weight: 600; }

        .warning-box { background: linear-gradient(135deg, rgba(239, 68, 68, 0.1), rgba(245, 158, 11, 0.1)); border: 1px solid var(--accent-amber); border-radius: 14px; padding: 1.2rem; margin: 1.5rem 0; text-align: left; }
        .warning-box h4 { color: var(--accent-amber); margin-bottom: 0.5rem; font-size: 1rem; }
        .warning-box p { color: var(--text-secondary); font-size: 0.9rem; line-height: 1.5; }
        .warning-box ul { color: var(--text-secondary); font-size: 0.85rem; margin-top: 0.5rem; padding-left: 1.2rem; }

        .question-limit { margin: 1.5rem 0; padding: 1.2rem; background: var(--bg-tertiary); border-radius: 14px; border: 1px solid var(--border-color); }
        .question-limit label { display: block; margin-bottom: 0.5rem; color: var(--text-secondary); }
        .question-limit input { width: 100px; padding: 0.6rem; border-radius: 10px; border: 1px solid var(--border-color); background: var(--bg-secondary); color: var(--text-primary); font-family: 'JetBrains Mono', monospace; font-size: 1rem; text-align: center; }

        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: var(--bg-secondary); border-radius: 4px; }
        ::-webkit-scrollbar-thumb { background: var(--border-color); border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: var(--accent-cyan); }

        @media (max-width: 768px) {
            .container { padding: 1rem; }
            .stats-bar { grid-template-columns: repeat(2, 1fr); }
            .header h1 { font-size: 1.5rem; }
            .start-info { grid-template-columns: 1fr; }
            .results-stats { grid-template-columns: 1fr; }
            .navigation { flex-direction: column; }
            .btn { width: 100%; justify-content: center; }
        }

        .hidden { display: none !important; }
        .fade-in { animation: fadeIn 0.5s ease forwards; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes pulse-green { 0%, 100% { box-shadow: 0 0 0 0 rgba(16, 185, 129, 0.4); } 50% { box-shadow: 0 0 0 10px rgba(16, 185, 129, 0); } }
        @keyframes pulse-red { 0%, 100% { box-shadow: 0 0 0 0 rgba(239, 68, 68, 0.4); } 50% { box-shadow: 0 0 0 10px rgba(239, 68, 68, 0); } }
        .option.correct { animation: pulse-green 0.5s ease; }
        .option.incorrect { animation: pulse-red 0.5s ease; }
    </style>
</head>
<body>
    <div class="bg-pattern"></div>
    
    <div class="container">
        <header class="header">
            <div class="logo-container">
                <div class="logo-icon">üõ°Ô∏è</div>
                <div>
                    <h1>Cumplimiento Normativo y Resiliencia</h1>
                    <p class="subtitle">Systems Engineering ‚Äî BBVA M√©xico</p>
                </div>
            </div>
            <div class="badge-container">
                <span class="badge badge-cyan">ENGINEERING</span>
                <span class="badge badge-emerald">COMPLIANCE</span>
                <span class="badge badge-amber">RESILIENCIA</span>
            </div>
        </header>

        <div id="startScreen" class="question-card start-screen">
            <h2>üéØ Evaluaci√≥n de Conocimientos</h2>
            <p style="color: var(--text-secondary); margin-bottom: 1rem;">
                Examen basado en el Cheat Sheet de Cumplimiento Normativo y Resiliencia.<br>
                Cubre regulaci√≥n, seguridad, SDLC, CVT y las 20 Reglas de Oro.
            </p>

            <div class="start-info">
                <div class="info-item">
                    <div class="info-icon">üìã</div>
                    <div class="info-text">
                        <h4>Total de preguntas</h4>
                        <p>65 preguntas</p>
                    </div>
                </div>
                <div class="info-item">
                    <div class="info-icon">üéØ</div>
                    <div class="info-text">
                        <h4>Temas</h4>
                        <p>12 categor√≠as</p>
                    </div>
                </div>
                <div class="info-item">
                    <div class="info-icon">‚ö†Ô∏è</div>
                    <div class="info-text">
                        <h4>Dificultad</h4>
                        <p>Media-Alta</p>
                    </div>
                </div>
                <div class="info-item">
                    <div class="info-icon">‚úÖ</div>
                    <div class="info-text">
                        <h4>Para aprobar</h4>
                        <p>75% m√≠nimo</p>
                    </div>
                </div>
            </div>

            <div class="warning-box">
                <h4>‚ö†Ô∏è Temas del Examen</h4>
                <ul>
                    <li>Marco Regulatorio (CNBV, Banxico, LFPDPPP)</li>
                    <li>Seguridad de la Informaci√≥n (CIDA, cifrado, accesos)</li>
                    <li>SDLC y Seguridad en el Desarrollo</li>
                    <li>CVT - 16 Controles de Validaci√≥n T√©cnica</li>
                    <li>Continuidad y Alta Disponibilidad (RTO, RPO, MTTR)</li>
                    <li>Las 3 L√≠neas de Defensa y las 20 Reglas de Oro</li>
                </ul>
            </div>

            <div class="question-limit">
                <label>N√∫mero de preguntas:</label>
                <input type="number" id="questionLimit" min="10" max="65" value="65">
                <span style="color: var(--text-muted); margin-left: 0.5rem;">(10-65)</span>
            </div>

            <button class="btn btn-primary" onclick="startExam()" style="margin-top: 1.5rem; padding: 1rem 3rem; font-size: 1.1rem;">
                üöÄ Iniciar Evaluaci√≥n
            </button>
        </div>

        <div id="examScreen" class="hidden">
            <div class="stats-bar">
                <div class="stat-card"><div class="stat-value" id="currentQuestion">1</div><div class="stat-label">Actual</div></div>
                <div class="stat-card correct-stat"><div class="stat-value correct" id="correctCount">0</div><div class="stat-label">Correctas</div></div>
                <div class="stat-card incorrect-stat"><div class="stat-value incorrect" id="incorrectCount">0</div><div class="stat-label">Incorrectas</div></div>
                <div class="stat-card"><div class="stat-value" id="totalQuestions">65</div><div class="stat-label">Total</div></div>
            </div>
            <div class="progress-container"><div class="progress-bar" id="progressBar" style="width: 0%"></div></div>
            <div class="question-nav" id="questionNav"></div>
            <div class="question-card fade-in" id="questionCard">
                <div class="question-header">
                    <span class="question-number" id="questionNumber">Pregunta 1</span>
                    <span class="question-category" id="questionCategory">Categor√≠a</span>
                    <span class="question-type" id="questionType">Tipo</span>
                    <span class="difficulty-badge" id="difficultyBadge">Dificultad</span>
                </div>
                <div id="scenarioBox"></div>
                <p class="question-text" id="questionText">Texto...</p>
                <div class="options-list" id="optionsList"></div>
                <div id="feedbackContainer"></div>
            </div>
            <div class="navigation">
                <button class="btn btn-secondary" id="prevBtn" onclick="prevQuestion()">‚Üê Anterior</button>
                <button class="btn btn-primary" id="nextBtn" onclick="nextQuestion()">Siguiente ‚Üí</button>
                <button class="btn btn-primary hidden" id="finishBtn" onclick="finishExam()">üèÅ Finalizar</button>
            </div>
        </div>

        <div id="resultsScreen" class="hidden">
            <div class="question-card results-container">
                <h2 style="margin-bottom: 1rem;">Resultados de la Evaluaci√≥n</h2>
                <div class="results-score" id="finalScore">0%</div>
                <div class="results-grade" id="gradeText">Calificaci√≥n</div>
                <div class="results-stats">
                    <div class="result-stat"><div class="result-stat-value correct" id="finalCorrectCount">0</div><div class="stat-label">Correctas</div></div>
                    <div class="result-stat"><div class="result-stat-value incorrect" id="finalIncorrectCount">0</div><div class="stat-label">Incorrectas</div></div>
                    <div class="result-stat"><div class="result-stat-value unanswered" id="finalUnansweredCount">0</div><div class="stat-label">Sin responder</div></div>
                </div>
                <div style="margin-top: 2rem; display: flex; gap: 1rem; justify-content: center; flex-wrap: wrap;">
                    <button class="btn btn-secondary" onclick="reviewAnswers()">üìã Revisar Respuestas</button>
                    <button class="btn btn-primary" onclick="restartExam()">üîÑ Nuevo Examen</button>
                </div>
            </div>
        </div>

        <div id="reviewScreen" class="hidden">
            <div class="question-card" style="margin-bottom: 1rem;">
                <h2 style="margin-bottom: 0.5rem;">Revisi√≥n de Respuestas</h2>
                <p style="color: var(--text-secondary);">An√°lisis detallado de cada pregunta</p>
            </div>
            <div id="reviewContainer"></div>
            <div class="navigation">
                <button class="btn btn-primary" onclick="backToResults()">‚Üê Volver a Resultados</button>
            </div>
        </div>
    </div>

    <script>
        const allQuestions = [
            // ========== MARCO REGULATORIO ==========
            {id:1,category:"Marco Regulatorio",type:"conceptual",difficulty:"hard",question:"¬øCu√°l es la funci√≥n principal de la CNBV y qu√© documento emite que es clave para Engineering?",options:["Banco central que emite circulares de pago","Supervisa y regula entidades financieras; emite la Circular √önica de Bancos (CUB)","Vigila protecci√≥n de datos personales; emite la LFPDPPP","Audita sistemas de informaci√≥n; emite normas ISO"],correct:1,explanation:"La CNBV supervisa y regula entidades financieras. La CUB consolida disposiciones sobre riesgo operacional, tecnol√≥gico, seguridad y continuidad."},
            
            {id:2,category:"Marco Regulatorio",type:"conceptual",difficulty:"medium",question:"¬øQu√© entidad vigila el cumplimiento de la LFPDPPP (protecci√≥n de datos personales)?",options:["CNBV","Banxico","Secretar√≠a Anticorrupci√≥n (antes INAI)","Auditor√≠a Interna"],correct:2,explanation:"La Secretar√≠a Anticorrupci√≥n (antes INAI) vigila el cumplimiento de la LFPDPPP."},
            
            {id:3,category:"Marco Regulatorio",type:"conceptual",difficulty:"hard",question:"¬øCu√°l es la relevancia de Banxico para Engineering?",options:["Emite la Circular √önica de Bancos","Regula ciberseguridad e infraestructura tecnol√≥gica para resiliencia del sistema financiero","Solo regula pol√≠tica monetaria","Audita sistemas internos del banco"],correct:1,explanation:"Banxico regula ciberseguridad e infraestructura tecnol√≥gica para resiliencia del sistema financiero."},
            
            // ========== RESILIENCIA DIGITAL ==========
            {id:4,category:"Resiliencia Digital",type:"conceptual",difficulty:"medium",question:"¬øQu√© es la Resiliencia Digital seg√∫n la Norma?",options:["Capacidad de crear software r√°pidamente","Capacidad para resistir, responder y recuperarnos de cualquier incidente tecnol√≥gico","Habilidad para automatizar pruebas","Proceso de migraci√≥n a la nube"],correct:1,explanation:"Resiliencia Digital: Capacidad para resistir, responder y recuperarnos de cualquier incidente tecnol√≥gico. Objetivo: que el banco siga funcionando."},
            
            {id:5,category:"Resiliencia Digital",type:"conceptual",difficulty:"hard",question:"¬øQu√© es el 'Modelo de Gobierno' en el contexto de Engineering?",options:["El organigrama del departamento","La 'constituci√≥n' de Engineering: norma fundacional de la que emanan todas las normativas espec√≠ficas","El proceso de aprobaci√≥n de cambios","La metodolog√≠a √°gil del equipo"],correct:1,explanation:"El Modelo de Gobierno es la 'constituci√≥n' de Engineering. Establece qui√©n toma decisiones, c√≥mo se estructuran equipos, y el origen del cuerpo normativo."},
            
            // ========== CUERPO NORMATIVO ==========
            {id:6,category:"Cuerpo Normativo",type:"tricky",difficulty:"expert",question:"¬øQu√© direcci√≥n es responsable del Modelo de Gobierno de Engineering?",options:["Systems","RCS Engineering","Strategy & Control","Information Security"],correct:2,explanation:"Strategy & Control es responsable del Modelo de Gobierno de Engineering, la 'constituci√≥n' que define estructura, roles y decisiones."},
            
            {id:7,category:"Cuerpo Normativo",type:"tricky",difficulty:"hard",question:"¬øQu√© direcci√≥n es responsable de las normas de SDLC, Testing e Integridad de Informaci√≥n?",options:["Information Security","Infrastructure & IT Ops","Systems","RCS Third Party"],correct:2,explanation:"Systems es responsable de SDLC, Seguridad en SDLC, Adquisici√≥n/Desarrollo/Mantenimiento, Testing e Integridad de Informaci√≥n."},
            
            {id:8,category:"Cuerpo Normativo",type:"tricky",difficulty:"hard",question:"¬øQu√© direcci√≥n maneja las normas de Riesgo TIC de Terceros y Ciclo de Vida de Servicios de Terceros?",options:["RCS Engineering","RCS Third Party","Information Security","Systems"],correct:1,explanation:"RCS Third Party maneja evaluaci√≥n, homologaci√≥n y supervisi√≥n continua de proveedores."},
            
            // ========== CLASIFICACI√ìN DE INFORMACI√ìN ==========
            {id:9,category:"Seguridad Info",type:"technical",difficulty:"expert",question:"¬øCu√°les son los 4 niveles de clasificaci√≥n de la informaci√≥n?",options:["Cr√≠tica, Alta, Media, Baja","P√∫blica, Interna, Confidencial, Secreta","Abierta, Restringida, Privada, Clasificada","Nivel 1, Nivel 2, Nivel 3, Nivel 4"],correct:1,explanation:"Los 4 niveles son: P√∫blica (libre acceso), Interna (solo empleados), Confidencial (acceso por roles), Secreta (m√°xima protecci√≥n)."},
            
            {id:10,category:"Seguridad Info",type:"technical",difficulty:"hard",question:"Para informaci√≥n clasificada como 'Secreta', ¬øcu√°les son los controles m√≠nimos?",options:["Solo control de acceso b√°sico","Cifrado, RBAC estricto y logs de acceso","Cifrado E2E, MFA, tokenizaci√≥n, pseudonimizaci√≥n y auditor√≠a total","Protecci√≥n b√°sica de integridad"],correct:2,explanation:"Informaci√≥n Secreta requiere: Cifrado E2E, MFA, tokenizaci√≥n, pseudonimizaci√≥n y auditor√≠a total."},
            
            {id:11,category:"Seguridad Info",type:"technical",difficulty:"medium",question:"¬øQu√© significa proteger datos 'En Tr√°nsito'?",options:["Datos almacenados en BD","Datos siendo procesados activamente","Datos movi√©ndose por la red - requiere cifrado TLS obligatorio","Datos en backup"],correct:2,explanation:"Datos En Tr√°nsito = datos movi√©ndose por la red. Requiere cifrado TLS de extremo a extremo obligatorio."},
            
            {id:12,category:"Seguridad Info",type:"technical",difficulty:"medium",question:"¬øQu√© control se aplica a datos 'En Reposo'?",options:["Cifrado TLS","Encriptaci√≥n de bases de datos","Controles de acceso RBAC","Tokenizaci√≥n"],correct:1,explanation:"Datos En Reposo (almacenados en BD, discos) requieren encriptaci√≥n de bases de datos."},
            
            // ========== CIDA ==========
            {id:13,category:"CIDA",type:"technical",difficulty:"expert",question:"¬øQu√© significan las siglas CIDA en el contexto de clasificaci√≥n de activos?",options:["Control Interno de Datos y Aplicaciones","Confidencialidad, Integridad, Disponibilidad, Autenticidad","Clasificaci√≥n Interna de Datos Activos","Centro de Informaci√≥n y Datos Automatizados"],correct:1,explanation:"CIDA = Confidencialidad, Integridad, Disponibilidad, Autenticidad. Son las 4 dimensiones para clasificar activos."},
            
            {id:14,category:"CIDA",type:"technical",difficulty:"hard",question:"La dimensi√≥n de 'Disponibilidad' en CIDA responde a la pregunta:",options:["¬øQu√© pasa si la informaci√≥n se fuga?","¬øQu√© pasa si los datos son alterados?","¬øQu√© pasa si la aplicaci√≥n no funciona?","¬øQu√© pasa si no confiamos en el origen?"],correct:2,explanation:"Disponibilidad: ¬øQu√© pasa si la aplicaci√≥n no funciona? Determina nivel de HA y estrategia de recuperaci√≥n."},
            
            {id:15,category:"CIDA",type:"technical",difficulty:"hard",question:"¬øQu√© dimensi√≥n CIDA determina los controles de hashing y firmas digitales?",options:["Confidencialidad","Integridad","Disponibilidad","Autenticidad"],correct:1,explanation:"Integridad: ¬øQu√© pasa si los datos son alterados? Determina controles de hashing y firmas digitales."},
            
            // ========== CRIPTOGRAF√çA ==========
            {id:16,category:"Criptograf√≠a",type:"technical",difficulty:"expert",question:"¬øCu√°les son los algoritmos de criptograf√≠a APROBADOS por el banco?",options:["MD5 (hash) y DES (cifrado)","SHA-1 (hash) y 3DES (cifrado)","AES-256 (cifrado) y SHA-256 (hash)","RSA-1024 y MD5"],correct:2,explanation:"Algoritmos aprobados: AES-256 (cifrado), SHA-256 (hash). Las claves deben rotarse peri√≥dicamente."},
            
            {id:17,category:"Criptograf√≠a",type:"technical",difficulty:"hard",question:"¬øQu√© est√° PROHIBIDO en criptograf√≠a seg√∫n la Norma?",options:["Usar AES-256","Rotar claves peri√≥dicamente","Crear implementaciones criptogr√°ficas personalizadas y almacenar claves en c√≥digo","Usar bibliotecas aprobadas"],correct:2,explanation:"PROHIBIDO: Crear implementaciones criptogr√°ficas personalizadas. NUNCA almacenar claves en c√≥digo o archivos de configuraci√≥n."},
            
            // ========== IDENTIDADES Y ACCESO ==========
            {id:18,category:"Identidades",type:"conceptual",difficulty:"hard",question:"El principio de 'M√≠nimo Privilegio' significa:",options:["Dar acceso de administrador a todos","Dise√±ar RBAC granular, denegar todo por defecto, solo permisos m√≠nimos indispensables","Permitir acceso temporal a todos los sistemas","Dar acceso solo a producci√≥n"],correct:1,explanation:"M√≠nimo Privilegio: Dise√±ar RBAC granular. Denegar todo por defecto. Solo permisos m√≠nimos e indispensables. Integrar MFA."},
            
            {id:19,category:"Identidades",type:"conceptual",difficulty:"hard",question:"¬øQu√© significa 'Segregaci√≥n de Funciones' en operaciones sensibles?",options:["Separar desarrollo de producci√≥n","Implementar 'cuatro ojos' / doble aprobaci√≥n: quien crea ‚â† quien autoriza","Dividir el equipo en subgrupos","Usar diferentes herramientas para cada funci√≥n"],correct:1,explanation:"Segregaci√≥n de Funciones: Implementar 'cuatro ojos' / doble aprobaci√≥n para operaciones sensibles. Quien crea ‚â† quien autoriza."},
            
            {id:20,category:"Identidades",type:"conceptual",difficulty:"medium",question:"¬øQu√© debe hacerse cuando un miembro del equipo cambia de funci√≥n o deja el banco?",options:["Nada, los accesos expiran autom√°ticamente","Notificar y revocar accesos a repositorios, herramientas y sistemas","Solo notificar a RRHH","Esperar a la siguiente auditor√≠a"],correct:1,explanation:"Ciclo de Vida del Empleado: Notificar cuando cambia de funci√≥n o deja el banco. Revocar accesos a repositorios, herramientas y sistemas."},
            
            {id:21,category:"Identidades",type:"technical",difficulty:"medium",question:"El principio de 'Trazabilidad' requiere:",options:["Solo registrar errores","Logs de auditor√≠a inmutables: qui√©n, qu√©, cu√°ndo, c√≥mo","Registrar solo accesos fallidos","Logs opcionales seg√∫n criticidad"],correct:1,explanation:"Trazabilidad: Todas las acciones deben quedar registradas. Logs de auditor√≠a inmutables: qui√©n, qu√©, cu√°ndo, c√≥mo."},
            
            // ========== REDES Y HARDENING ==========
            {id:22,category:"Redes",type:"technical",difficulty:"hard",question:"¬øQu√© es la 'Segmentaci√≥n de Red'?",options:["Dividir el c√≥digo en m√≥dulos","Infraestructura dividida en zonas de seguridad (producci√≥n, desarrollo, DMZ) con tr√°fico restringido","Separar bases de datos","Usar diferentes proveedores de internet"],correct:1,explanation:"Segmentaci√≥n de Red: Infraestructura dividida en zonas de seguridad. Tr√°fico restringido entre zonas."},
            
            {id:23,category:"Redes",type:"technical",difficulty:"medium",question:"El principio de los Firewalls es:",options:["Permitir todo por defecto","Denegar por defecto, solo tr√°fico expl√≠citamente autorizado","Bloquear solo puertos conocidos","Permitir todo el tr√°fico interno"],correct:1,explanation:"Firewalls: Denegar por defecto. Solo tr√°fico expl√≠citamente autorizado."},
            
            {id:24,category:"Redes",type:"technical",difficulty:"hard",question:"¬øQu√© es 'Hardening' y cu√°l es tu responsabilidad como desarrollador?",options:["Aumentar recursos del servidor","Configuraciones de seguridad estandarizadas; desarrollar para entornos minimalistas y usar Golden Images corporativas","Endurecer las pruebas","Aumentar la cobertura de c√≥digo"],correct:1,explanation:"Hardening: Configuraciones de seguridad estandarizadas, solo servicios necesarios. Tu responsabilidad: desarrollar para entornos minimalistas, declarar dependencias, usar Golden Images."},
            
            // ========== MONITORIZACI√ìN Y VULNERABILIDADES ==========
            {id:25,category:"Monitorizaci√≥n",type:"technical",difficulty:"hard",question:"¬øQu√© informaci√≥n debe incluir un log de alta calidad?",options:["Solo errores","Solo accesos exitosos","Qui√©n, qu√©, cu√°ndo, c√≥mo - con suficiente detalle","Solo datos de rendimiento"],correct:2,explanation:"Logs de alta calidad: qui√©n, qu√©, cu√°ndo, c√≥mo, con suficiente detalle. Eventos clave: login exitosos/fallidos, cambios de configuraci√≥n, accesos a ficheros, errores cr√≠ticos."},
            
            {id:26,category:"Monitorizaci√≥n",type:"technical",difficulty:"expert",question:"¬øQu√© est√° PROHIBIDO incluir en los logs?",options:["Timestamps","IPs de origen","Datos sensibles (contrase√±as, datos personales, tokens)","Identificadores de usuario"],correct:2,explanation:"NUNCA registrar datos sensibles en los logs: contrase√±as, datos personales, tokens."},
            
            {id:27,category:"Vulnerabilidades",type:"technical",difficulty:"expert",question:"Para vulnerabilidades de criticidad CR√çTICA, ¬øcu√°l es la acci√≥n requerida?",options:["Incluir en backlog de mantenimiento","Planificar parche dentro del SLA","M√ÅXIMA PRIORIDAD: Correcci√≥n inmediata por encima de nuevas funcionalidades","Descartar si es falso positivo"],correct:2,explanation:"Vulnerabilidades CR√çTICAS: M√ÅXIMA PRIORIDAD. Correcci√≥n inmediata por encima de nuevas funcionalidades."},
            
            {id:28,category:"Vulnerabilidades",type:"technical",difficulty:"hard",question:"¬øCu√°les son las herramientas del pipeline CI/CD para gesti√≥n de vulnerabilidades?",options:["Solo SonarQube","SAST, DAST, SCA y Chimera","Solo pruebas manuales","Jenkins y GitHub Actions"],correct:1,explanation:"Herramientas en pipeline: SAST (An√°lisis Est√°tico), DAST (An√°lisis Din√°mico), SCA (An√°lisis de Componentes), Chimera (reportes)."},
            
            // ========== INCIDENTES DE SEGURIDAD ==========
            {id:29,category:"Incidentes",type:"scenario",difficulty:"expert",scenario:"Detectas un comportamiento an√≥malo en producci√≥n: consultas SQL inusuales a las 3AM desde una IP desconocida.",question:"¬øCu√°l es tu PRIMERA acci√≥n seg√∫n la Norma?",options:["Investigar por tu cuenta antes de reportar","Reportar INMEDIATAMENTE al CSIRT/CERT sin asumir que es un error sin importancia","Esperar a ver si se repite","Notificar a tu Tech Lead al d√≠a siguiente"],correct:1,explanation:"Fase de Detecci√≥n: Reportar INMEDIATAMENTE cualquier comportamiento an√≥malo al CSIRT/CERT. NO asumir que es un error sin importancia."},
            
            {id:30,category:"Incidentes",type:"conceptual",difficulty:"hard",question:"En la fase de 'Contenci√≥n' de un incidente, ¬øc√≥mo ayuda el principio de m√≠nimo privilegio?",options:["No tiene relaci√≥n","Limita el da√±o si una cuenta es comprometida","Acelera la investigaci√≥n","Facilita la comunicaci√≥n"],correct:1,explanation:"Contenci√≥n: El m√≠nimo privilegio en tu dise√±o limita el da√±o si una cuenta es comprometida."},
            
            {id:31,category:"Incidentes",type:"conceptual",difficulty:"medium",question:"¬øQu√© debes implementar despu√©s de un incidente seg√∫n las 'Lecciones Aprendidas'?",options:["Solo documentar el incidente","Participar en post-mortem e implementar mejoras: timeouts, reintentos, circuit breakers","Cambiar todas las contrase√±as","Reinstalar todos los servidores"],correct:1,explanation:"Lecciones Aprendidas: Participar en post-mortem. Implementar mejoras: timeouts, reintentos, circuit breakers."},
            
            // ========== SDLC ==========
            {id:32,category:"SDLC",type:"technical",difficulty:"hard",question:"¬øQu√© control de seguridad se integra en la fase de AN√ÅLISIS del SDLC?",options:["SAST","Hacking √âtico","An√°lisis de Riesgo Tecnol√≥gico (ART)","DAST"],correct:2,explanation:"Fase de An√°lisis: Requisitos funcionales y no funcionales + An√°lisis de Riesgo Tecnol√≥gico (ART)."},
            
            {id:33,category:"SDLC",type:"technical",difficulty:"hard",question:"¬øQu√© controles se integran en la fase de DISE√ëO?",options:["SAST y SCA","Modelado de Amenazas (Threat Modeling) y Security by Design","CVT y CRQ","DAST y Hacking √âtico"],correct:1,explanation:"Fase de Dise√±o: Modelado de Amenazas (Threat Modeling), Security by Design. Documentar decisiones de dise√±o."},
            
            {id:34,category:"SDLC",type:"technical",difficulty:"medium",question:"¬øQu√© controles se integran en la fase de CONSTRUCCI√ìN?",options:["Hacking √âtico","CVT completo","SAST, SCA, Codificaci√≥n Segura (OWASP Top 10)","Solo pruebas manuales"],correct:2,explanation:"Fase de Construcci√≥n: SAST, SCA, Codificaci√≥n Segura (OWASP Top 10)."},
            
            {id:35,category:"SDLC",type:"technical",difficulty:"hard",question:"¬øQu√© es el 'CVT' en la fase de DESPLIEGUE?",options:["Una herramienta de versionado","El hito final (gate) que debe completarse antes de producci√≥n","Un tipo de prueba automatizada","El plan de rollback"],correct:1,explanation:"Fase de Despliegue: CVT como hito final (gate). CRQ aprobado + Plan Instalaci√≥n + Plan Rollback."},
            
            // ========== SHIFT LEFT ==========
            {id:36,category:"Shift Left",type:"conceptual",difficulty:"medium",question:"¬øQu√© significa el principio 'Shift Left' en seguridad?",options:["Mover la seguridad al final del ciclo","Mover la seguridad hacia la IZQUIERDA (fases m√°s tempranas) del ciclo de vida","Priorizar pruebas de rendimiento","Delegar seguridad a un equipo aparte"],correct:1,explanation:"Shift Left: Mover la seguridad hacia la izquierda del ciclo de vida. Encontrar y arreglar problemas en las fases m√°s tempranas y baratas."},
            
            {id:37,category:"Shift Left",type:"conceptual",difficulty:"hard",question:"Seg√∫n la Norma, ¬øde qui√©n es responsabilidad la seguridad?",options:["Del equipo de InfoSec exclusivamente","Del equipo de QA","Es TU responsabilidad como desarrollador profesional, no de un equipo aparte","Del Release Manager"],correct:2,explanation:"La seguridad es parte de TU responsabilidad como desarrollador profesional, no de un equipo aparte."},
            
            // ========== OWASP ==========
            {id:38,category:"OWASP",type:"technical",difficulty:"hard",question:"¬øQu√© pr√°ctica de codificaci√≥n segura previene Inyecci√≥n SQL y XSS?",options:["Usar frameworks modernos","Validaci√≥n estricta de TODAS las entradas del usuario","Cifrar todas las respuestas","Usar HTTPS"],correct:1,explanation:"Pr√°cticas OWASP: Validaci√≥n estricta de TODAS las entradas del usuario (previene Inyecci√≥n SQL y XSS)."},
            
            {id:39,category:"OWASP",type:"technical",difficulty:"medium",question:"¬øQu√© debe evitarse en el manejo de errores seg√∫n OWASP?",options:["Registrar errores en logs","Mostrar errores al usuario","Revelar informaci√≥n sensible en mensajes de error","Usar try-catch"],correct:2,explanation:"Manejo seguro de errores: No revelar informaci√≥n sensible en mensajes de error."},
            
            // ========== TESTING ==========
            {id:40,category:"Testing",type:"technical",difficulty:"hard",question:"¬øDe qu√© tipo de pruebas eres el PRINCIPAL responsable como desarrollador?",options:["Pruebas de rendimiento","Pruebas unitarias - alta cobertura obligatoria","Pruebas de aceptaci√≥n","Hacking √âtico"],correct:1,explanation:"Pruebas Unitarias: T√∫ eres el principal responsable. Alta cobertura obligatoria."},
            
            {id:41,category:"Testing",type:"conceptual",difficulty:"medium",question:"Seg√∫n la 'Regla de Oro del Testing':",options:["Las pruebas manuales son preferibles","Un c√≥digo sin pruebas es un c√≥digo incompleto; la calidad NO es negociable","Las pruebas son opcionales si hay presi√≥n de tiempo","Solo se prueban funcionalidades nuevas"],correct:1,explanation:"Regla de Oro: Un c√≥digo sin pruebas es un c√≥digo incompleto. La calidad NO es negociable."},
            
            {id:42,category:"Testing",type:"technical",difficulty:"hard",question:"¬øD√≥nde deben estar integradas TODAS las pruebas?",options:["En un servidor separado","En el pipeline CI/CD para validaci√≥n continua con cada cambio","Solo en ambientes de QA","En producci√≥n"],correct:1,explanation:"Toda prueba debe estar automatizada e integrada en el pipeline CI/CD para validaci√≥n continua con cada cambio."},
            
            // ========== CONTINUIDAD Y HA ==========
            {id:43,category:"Continuidad",type:"technical",difficulty:"expert",question:"¬øQu√© es el RTO (Recovery Time Objective)?",options:["Cantidad m√°xima de p√©rdida de datos aceptable","Tiempo m√°ximo aceptable para recuperar el servicio","Tiempo promedio de recuperaci√≥n","Tiempo para detectar un problema"],correct:1,explanation:"RTO: Tiempo m√°ximo aceptable para recuperar el servicio. Determina la arquitectura que debes implementar."},
            
            {id:44,category:"Continuidad",type:"technical",difficulty:"expert",question:"¬øQu√© es el RPO (Recovery Point Objective)?",options:["Tiempo m√°ximo para recuperar el servicio","Cantidad m√°xima aceptable de p√©rdida de datos","Tiempo promedio de detecci√≥n","Frecuencia de monitoreo"],correct:1,explanation:"RPO: Cantidad m√°xima aceptable de p√©rdida de datos. Determina frecuencia de backups y estrategia de replicaci√≥n."},
            
            {id:45,category:"Continuidad",type:"technical",difficulty:"hard",question:"¬øQu√© es el MTTR y c√≥mo se minimiza?",options:["Mean Time To Recovery; con runbooks detallados, pruebas de DR y automatizaci√≥n","Mean Time To Report; con mejor comunicaci√≥n","Maximum Time To Restore; no se puede minimizar","Minimum Time To Respond; con m√°s personal"],correct:0,explanation:"MTTR: Mean Time To Recovery (tiempo promedio de recuperaci√≥n). Se minimiza con runbooks detallados, pruebas de DR y automatizaci√≥n."},
            
            {id:46,category:"Continuidad",type:"technical",difficulty:"hard",question:"¬øQu√© es el MTTD y c√≥mo se reduce?",options:["Mean Time To Deploy","Mean Time To Detect; exponiendo m√©tricas (/health), definiendo umbrales de alerta","Maximum Time To Debug","Minimum Time To Deliver"],correct:1,explanation:"MTTD: Mean Time To Detect (tiempo promedio en detectar un problema). Se reduce con endpoint /health y umbrales de alerta."},
            
            // ========== ALTA DISPONIBILIDAD ==========
            {id:47,category:"Alta Disponibilidad",type:"technical",difficulty:"hard",question:"¬øCu√°les son los principios de dise√±o para Alta Disponibilidad?",options:["Solo usar la nube","Redundancia, Health Checks, Failover Autom√°tico, Sin SPOFs, Sesi√≥n externalizada","M√°s servidores = mejor","Solo backups frecuentes"],correct:1,explanation:"Principios de HA: Redundancia (cl√∫ster activo-activo), Health Checks (/health), Failover Autom√°tico, Sin SPOFs, Sesi√≥n externalizada."},
            
            {id:48,category:"Alta Disponibilidad",type:"technical",difficulty:"medium",question:"¬øQu√© significa que una aplicaci√≥n sea 'STATELESS'?",options:["No tiene base de datos","No guarda estado en la instancia; permite m√∫ltiples instancias redundantes","No tiene configuraci√≥n","No tiene logs"],correct:1,explanation:"Aplicaciones STATELESS no guardan estado en la instancia. Permite m√∫ltiples instancias (cl√∫ster activo-activo). Sesi√≥n en componente externo compartido."},
            
            {id:49,category:"Alta Disponibilidad",type:"technical",difficulty:"medium",question:"¬øQu√© es un SPOF y qu√© debes hacer con √©l?",options:["Single Point of Failure; eliminarlo de la arquitectura","Security Point of Focus; monitorearlo","Service Provider of Functions; documentarlo","Standard Process of Failover; implementarlo"],correct:0,explanation:"SPOF: Single Point of Failure. Debes eliminar TODOS los SPOFs de la arquitectura."},
            
            // ========== BACKUPS Y DR ==========
            {id:50,category:"Backups",type:"technical",difficulty:"hard",question:"¬øQu√© son las copias 'inmutables/air-gapped' y para qu√© sirven?",options:["Copias en la nube","√öltima l√≠nea de defensa contra ransomware","Copias en el mismo servidor","Backups incrementales"],correct:1,explanation:"Copias inmutables/air-gapped: √∫ltima l√≠nea de defensa contra ransomware."},
            
            {id:51,category:"Resiliencia",type:"technical",difficulty:"hard",question:"En pruebas de Chaos Engineering, ¬øqu√© mejoras debes implementar despu√©s?",options:["Solo documentar los fallos","Timeouts, reintentos, circuit breakers","M√°s servidores","Cambiar de proveedor"],correct:1,explanation:"Despu√©s de Chaos Engineering: Implementar mejoras como timeouts, reintentos, circuit breakers."},
            
            // ========== CMDB Y OPERACI√ìN ==========
            {id:52,category:"CMDB",type:"technical",difficulty:"medium",question:"¬øQu√© debes registrar de tu aplicaci√≥n en la CMDB?",options:["Solo el nombre","La aplicaci√≥n, sus componentes y todas sus dependencias mapeadas","Solo las APIs","Solo las bases de datos"],correct:1,explanation:"CMDB: Registrar tu aplicaci√≥n y sus componentes. Mapear dependencias: BDs, APIs que consume, servicios de terceros."},
            
            {id:53,category:"Operaci√≥n",type:"technical",difficulty:"hard",question:"¬øQu√© debe incluir un Runbook?",options:["Solo el c√≥digo fuente","Arranque, parada, alertas comunes, diagn√≥stico b√°sico","Solo la arquitectura","Solo los contactos del equipo"],correct:1,explanation:"Runbooks: Crear y mantener actualizados. Incluir: arranque, parada, alertas comunes, diagn√≥stico b√°sico."},
            
            // ========== OBSOLESCENCIA ==========
            {id:54,category:"Obsolescencia",type:"conceptual",difficulty:"hard",question:"¬øPor qu√© es peligroso usar software sin soporte?",options:["Es m√°s lento","Es una puerta abierta a atacantes (sin parches de seguridad)","Cuesta m√°s","Es m√°s dif√≠cil de configurar"],correct:1,explanation:"Software sin soporte = puerta abierta a atacantes (sin parches de seguridad)."},
            
            {id:55,category:"Obsolescencia",type:"conceptual",difficulty:"medium",question:"¬øQu√© versiones de software debes usar seg√∫n la Norma?",options:["Las m√°s nuevas (beta)","Versiones con soporte a largo plazo (LTS)","Las que use el equipo","Las m√°s populares"],correct:1,explanation:"SIEMPRE usar versiones con soporte a largo plazo (LTS). NUNCA usar versiones beta o a punto de perder soporte."},
            
            // ========== TERCEROS ==========
            {id:56,category:"Terceros",type:"technical",difficulty:"hard",question:"¬øPuedes trabajar con un proveedor que NO ha sido homologado?",options:["S√≠, si es urgente","S√≠, con aprobaci√≥n del PO","NO, no puedes trabajar con proveedor no homologado","S√≠, temporalmente"],correct:2,explanation:"No puedes trabajar con proveedor no homologado. Debes planificar tiempos para el proceso de homologaci√≥n (Due Diligence)."},
            
            {id:57,category:"Terceros",type:"scenario",difficulty:"hard",scenario:"Un proveedor de servicios cloud que usas notifica que sufri√≥ un incidente de seguridad que podr√≠a afectar tus datos.",question:"¬øCu√°l es tu responsabilidad?",options:["Esperar a que el proveedor lo resuelva","Evaluar impacto en tus apps y activar contingencia si es necesario (deshabilitar integraci√≥n)","Notificar solo si hay p√©rdida de datos confirmada","Documentar para la siguiente auditor√≠a"],correct:1,explanation:"Incidente de Tercero: Evaluar impacto en tus apps. Activar contingencia si es necesario (deshabilitar integraci√≥n)."},
            
            // ========== TRES L√çNEAS DE DEFENSA ==========
            {id:58,category:"3 L√≠neas",type:"conceptual",difficulty:"expert",question:"En el Modelo de las Tres L√≠neas, ¬øqui√©n es la 1¬™ L√≠nea de Defensa?",options:["Auditor√≠a Interna","RCS IT","T√∫, tu equipo, Tech Leads, POs - due√±os del riesgo","Reguladores externos"],correct:2,explanation:"1¬™ L√≠nea: T√∫, tu equipo, Tech Leads, POs. Due√±os del riesgo. Conocer y aplicar normativas. Herramienta: CVT."},
            
            {id:59,category:"3 L√≠neas",type:"conceptual",difficulty:"hard",question:"¬øCu√°l es la responsabilidad de la 2¬™ L√≠nea (RCS IT)?",options:["Ejecutar el c√≥digo","Establecer reglas, asesorar, verificar independientemente. Challenge constructivo.","Aprobar cambios en producci√≥n","Auditar anualmente"],correct:1,explanation:"2¬™ L√≠nea (RCS IT): Establecer reglas, asesorar, verificar independientemente. Challenge constructivo."},
            
            {id:60,category:"3 L√≠neas",type:"conceptual",difficulty:"hard",question:"¬øQu√© es el proceso TOE (Test of Effectiveness)?",options:["Prueba de dise√±o del control","Verificaci√≥n de ejecuci√≥n real: seleccionan muestra y TE PIDEN EVIDENCIA","Prueba de eficiencia del c√≥digo","Test de rendimiento"],correct:1,explanation:"TOE: Verifica ejecuci√≥n real. Seleccionan muestra (ej. 15 CRQs). TE PIDEN EVIDENCIA."},
            
            // ========== CVT ==========
            {id:61,category:"CVT",type:"technical",difficulty:"expert",question:"¬øCu√°ntos controles tiene el CVT (Checklist de Validaci√≥n T√©cnica)?",options:["10 controles","12 controles","16 controles","20 controles"],correct:2,explanation:"El CVT tiene 16 controles que deben verificarse antes de cada pase a producci√≥n."},
            
            {id:62,category:"CVT",type:"technical",difficulty:"hard",question:"¬øQu√© sucede si el CVT est√° incompleto?",options:["Se despliega con advertencia","El despliegue es DETENIDO hasta subsanaci√≥n","Se aprueba con excepciones","Se escala al PO"],correct:1,explanation:"CVT incompleto = despliegue DETENIDO hasta subsanaci√≥n."},
            
            {id:63,category:"CVT",type:"technical",difficulty:"hard",question:"¬øD√≥nde se almacena el Expediente T√©cnico B√°sico con las evidencias del CVT?",options:["En Jira","En el repositorio de c√≥digo","En el Centro √önico de Conocimiento (CUC)","En SharePoint personal"],correct:2,explanation:"Expediente final se almacena en el Centro √önico de Conocimiento (CUC)."},
            
            {id:64,category:"CVT",type:"technical",difficulty:"expert",question:"¬øQu√© control del CVT requiere el documento de autorizaci√≥n para usar datos reales en ambientes previos?",options:["DyD-001","DyD-006","DyD-09","PRO-01"],correct:2,explanation:"DyD-09 (Consentimiento Datos Reales): Documento de autorizaci√≥n para usar datos reales en ambientes previos."},
            
            // ========== SEGURIDAD F√çSICA ==========
            {id:65,category:"Seg. F√≠sica",type:"conceptual",difficulty:"medium",question:"¬øCu√°l es tu responsabilidad respecto a tu port√°til corporativo?",options:["Solo no perderlo","Eres directamente responsable; su robo puede ser un incidente grave","Solo mantenerlo actualizado","No tienes responsabilidad especial"],correct:1,explanation:"Proteger tu port√°til: eres directamente responsable. Su robo puede ser un incidente grave."}
        ];

        let questions = [];
        let currentQuestionIndex = 0;
        let userAnswers = {};
        let answerResults = {};
        let correctCount = 0;
        let incorrectCount = 0;
        let shuffledOptions = {};

        function shuffleArray(array) {
            const newArray = [...array];
            for (let i = newArray.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [newArray[i], newArray[j]] = [newArray[j], newArray[i]];
            }
            return newArray;
        }

        function shuffleOptionsForQuestion(question, qIndex) {
            const indices = question.options.map((_, i) => i);
            const shuffledIndices = shuffleArray(indices);
            const newCorrectIndex = shuffledIndices.indexOf(question.correct);
            shuffledOptions[qIndex] = { indices: shuffledIndices, correctIndex: newCorrectIndex };
        }

        function startExam() {
            let limit = parseInt(document.getElementById('questionLimit').value) || 65;
            limit = Math.max(10, Math.min(65, limit));
            questions = shuffleArray([...allQuestions]).slice(0, limit);
            shuffledOptions = {};
            questions.forEach((q, i) => shuffleOptionsForQuestion(q, i));
            currentQuestionIndex = 0;
            userAnswers = {};
            answerResults = {};
            correctCount = 0;
            incorrectCount = 0;
            document.getElementById('startScreen').classList.add('hidden');
            document.getElementById('examScreen').classList.remove('hidden');
            document.getElementById('totalQuestions').textContent = questions.length;
            renderQuestionNav();
            renderQuestion();
            updateStats();
        }

        function renderQuestionNav() {
            const nav = document.getElementById('questionNav');
            nav.innerHTML = '';
            questions.forEach((_, index) => {
                const btn = document.createElement('button');
                btn.className = 'nav-btn';
                if (index === currentQuestionIndex) btn.classList.add('current');
                if (answerResults[index] === true) btn.classList.add('correct');
                if (answerResults[index] === false) btn.classList.add('incorrect');
                btn.textContent = index + 1;
                btn.onclick = () => goToQuestion(index);
                nav.appendChild(btn);
            });
        }

        function goToQuestion(index) { currentQuestionIndex = index; renderQuestion(); renderQuestionNav(); }

        function updateStats() {
            document.getElementById('correctCount').textContent = correctCount;
            document.getElementById('incorrectCount').textContent = incorrectCount;
            const answeredCount = Object.keys(userAnswers).length;
            const progress = (answeredCount / questions.length) * 100;
            document.getElementById('progressBar').style.width = `${progress}%`;
        }

        function renderQuestion() {
            const question = questions[currentQuestionIndex];
            const shuffled = shuffledOptions[currentQuestionIndex];
            const isAnswered = userAnswers[currentQuestionIndex] !== undefined;
            const userAnswer = userAnswers[currentQuestionIndex];
            const isCorrect = answerResults[currentQuestionIndex];
            
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            document.getElementById('questionNumber').textContent = `Pregunta ${currentQuestionIndex + 1}`;
            document.getElementById('questionCategory').textContent = question.category;
            
            const typeLabel = document.getElementById('questionType');
            const typeMap = {scenario:'Escenario',conceptual:'Conceptual',technical:'T√©cnica',tricky:'Detalle'};
            typeLabel.textContent = typeMap[question.type] || question.type;
            typeLabel.className = `question-type ${question.type}`;
            
            const diffBadge = document.getElementById('difficultyBadge');
            diffBadge.textContent = question.difficulty === 'expert' ? 'Experto' : question.difficulty === 'hard' ? 'Dif√≠cil' : 'Media';
            diffBadge.className = `difficulty-badge ${question.difficulty}`;
            
            const scenarioBox = document.getElementById('scenarioBox');
            scenarioBox.innerHTML = question.scenario ? `<div class="scenario-box">üìã <strong>Escenario:</strong><br>${question.scenario}</div>` : '';
            
            document.getElementById('questionText').innerHTML = question.question;
            
            const questionCard = document.getElementById('questionCard');
            questionCard.classList.remove('answered-correct', 'answered-incorrect');
            if (isAnswered) questionCard.classList.add(isCorrect ? 'answered-correct' : 'answered-incorrect');
            
            const optionsList = document.getElementById('optionsList');
            const letters = ['A', 'B', 'C', 'D', 'E'];
            optionsList.innerHTML = shuffled.indices.map((originalIndex, displayIndex) => {
                const option = question.options[originalIndex];
                let className = 'option';
                let feedback = '';
                if (isAnswered) {
                    className += ' disabled';
                    if (displayIndex === shuffled.correctIndex) {
                        className += ' correct';
                        feedback = displayIndex === userAnswer ? '<span class="option-feedback correct">‚úì ¬°Correcto!</span>' : '<span class="option-feedback correct">‚úì Correcta</span>';
                        if (displayIndex !== userAnswer) className += ' show-correct';
                    } else if (displayIndex === userAnswer) {
                        className += ' incorrect';
                        feedback = '<span class="option-feedback incorrect">‚úó Incorrecto</span>';
                    }
                }
                return `<div class="${className}" onclick="${isAnswered ? '' : `selectOption(${displayIndex})`}"><span class="option-letter">${letters[displayIndex]}</span><span class="option-text">${option}</span>${feedback}</div>`;
            }).join('');
            
            const feedbackContainer = document.getElementById('feedbackContainer');
            if (isAnswered) {
                let feedbackHTML = isCorrect ? '<div class="feedback-message correct"><span class="feedback-icon">‚úÖ</span><span>¬°Correcto!</span></div>' : '<div class="feedback-message incorrect"><span class="feedback-icon">‚ùå</span><span>Incorrecto</span></div>';
                if (question.explanation) feedbackHTML += `<div class="explanation"><strong>üìñ Explicaci√≥n:</strong> ${question.explanation}</div>`;
                feedbackContainer.innerHTML = feedbackHTML;
            } else feedbackContainer.innerHTML = '';
            
            document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
            if (currentQuestionIndex === questions.length - 1) {
                document.getElementById('nextBtn').classList.add('hidden');
                document.getElementById('finishBtn').classList.remove('hidden');
            } else {
                document.getElementById('nextBtn').classList.remove('hidden');
                document.getElementById('finishBtn').classList.add('hidden');
            }
        }

        function selectOption(displayIndex) {
            if (userAnswers[currentQuestionIndex] !== undefined) return;
            const shuffled = shuffledOptions[currentQuestionIndex];
            const isCorrect = displayIndex === shuffled.correctIndex;
            userAnswers[currentQuestionIndex] = displayIndex;
            answerResults[currentQuestionIndex] = isCorrect;
            if (isCorrect) correctCount++; else incorrectCount++;
            updateStats();
            renderQuestion();
            renderQuestionNav();
        }

        function prevQuestion() { if (currentQuestionIndex > 0) { currentQuestionIndex--; renderQuestion(); renderQuestionNav(); } }
        function nextQuestion() { if (currentQuestionIndex < questions.length - 1) { currentQuestionIndex++; renderQuestion(); renderQuestionNav(); } }

        function finishExam() {
            const unanswered = questions.length - Object.keys(userAnswers).length;
            const score = Math.round((correctCount / questions.length) * 100);
            document.getElementById('examScreen').classList.add('hidden');
            document.getElementById('resultsScreen').classList.remove('hidden');
            document.getElementById('finalScore').textContent = `${score}%`;
            document.getElementById('finalCorrectCount').textContent = correctCount;
            document.getElementById('finalIncorrectCount').textContent = incorrectCount;
            document.getElementById('finalUnansweredCount').textContent = unanswered;
            let gradeText = '', gradeEmoji = '';
            if (score >= 90) { gradeText = 'Excelente'; gradeEmoji = 'üèÜ'; }
            else if (score >= 80) { gradeText = 'Muy Bien'; gradeEmoji = 'üéâ'; }
            else if (score >= 75) { gradeText = 'Aprobado'; gradeEmoji = '‚úÖ'; }
            else if (score >= 60) { gradeText = 'Necesita Mejorar'; gradeEmoji = 'üìö'; }
            else { gradeText = 'No Aprobado'; gradeEmoji = '‚ùå'; }
            document.getElementById('gradeText').textContent = `${gradeEmoji} ${gradeText}`;
        }

        function reviewAnswers() {
            document.getElementById('resultsScreen').classList.add('hidden');
            document.getElementById('reviewScreen').classList.remove('hidden');
            const container = document.getElementById('reviewContainer');
            const letters = ['A', 'B', 'C', 'D', 'E'];
            const typeMap = {scenario:'Escenario',conceptual:'Conceptual',technical:'T√©cnica',tricky:'Detalle'};
            container.innerHTML = questions.map((question, qIndex) => {
                const shuffled = shuffledOptions[qIndex];
                const userAnswer = userAnswers[qIndex];
                const isCorrect = answerResults[qIndex];
                const isUnanswered = userAnswer === undefined;
                return `<div class="question-card fade-in" style="animation-delay: ${qIndex * 0.02}s">
                    <div class="question-header">
                        <span class="question-number">Pregunta ${qIndex + 1}</span>
                        <span class="question-category">${question.category}</span>
                        <span class="question-type ${question.type}">${typeMap[question.type]||question.type}</span>
                        <span style="margin-left: auto; font-size: 1.5rem;">${isUnanswered ? '‚ö†Ô∏è' : (isCorrect ? '‚úÖ' : '‚ùå')}</span>
                    </div>
                    ${question.scenario ? `<div class="scenario-box">üìã <strong>Escenario:</strong><br>${question.scenario}</div>` : ''}
                    <p class="question-text">${question.question}</p>
                    <div class="options-list">${shuffled.indices.map((originalIndex, displayIndex) => {
                        const option = question.options[originalIndex];
                        let className = 'option disabled';
                        let feedback = '';
                        if (displayIndex === shuffled.correctIndex) { className += ' correct'; feedback = '<span class="option-feedback correct">‚úì Correcta</span>'; }
                        else if (displayIndex === userAnswer && !isCorrect) { className += ' incorrect'; feedback = '<span class="option-feedback incorrect">Tu respuesta</span>'; }
                        return `<div class="${className}"><span class="option-letter">${letters[displayIndex]}</span><span class="option-text">${option}</span>${feedback}</div>`;
                    }).join('')}</div>
                    ${question.explanation ? `<div class="explanation"><strong>üìñ Explicaci√≥n:</strong> ${question.explanation}</div>` : ''}
                </div>`;
            }).join('');
        }

        function backToResults() { document.getElementById('reviewScreen').classList.add('hidden'); document.getElementById('resultsScreen').classList.remove('hidden'); }

        function restartExam() {
            document.getElementById('resultsScreen').classList.add('hidden');
            document.getElementById('reviewScreen').classList.add('hidden');
            document.getElementById('startScreen').classList.remove('hidden');
            questions = []; currentQuestionIndex = 0; userAnswers = {}; answerResults = {}; correctCount = 0; incorrectCount = 0; shuffledOptions = {};
        }
    </script>
</body>
</html>
